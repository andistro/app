#!/bin/bash

# ========================================
# AnDistro: Confirmação de autoboot
# ========================================
if command -v andistro >/dev/null 2>&1; then
    source "$PREFIX/var/lib/andistro/lib/share/global" 2>/dev/null || true

    msg_andistro=$(printf "$label_open_app_desc" "Andistro")

    echo
    echo -e "\e[1;33m$msg_andistro\e[0m"

    trap "echo -e '\n\e[1;32m$label_cancel_action_ctrlc\e[0m'; exec bash" INT
    read -rsn1 tecla
    trap - INT

    if [[ -z "$tecla" || "$tecla" == $'\r' || "$tecla" == $'\n' ]]; then
        echo -e "\n\e[1;32m$(printf "$label_opening" "Andistro")\e[0m"
        echo -e "\n\e[1;32m$label_continue_action_executed\e[0m"
        echo -e "\e[1;32m$label_action_accepted\n\n\e[0m"
        andistro >/dev/null 2>&1  # ← Sem & aqui!
        exec bash
    fi

    if [[ "$tecla" == $'\x1b' ]]; then
        echo -e "\n\e[1;32m$label_cancel_action_esc\e[0m"
    fi

    exec bash
fi
# ========================================
# AnDistro: Fim da confirmação de autoboot
# ========================================